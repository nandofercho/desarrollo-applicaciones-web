{% extends "base.html" %}
{% block title %}{{ 'Nuevo producto' if modo=='crear' else 'Editar producto' }}{% endblock %}

{% block content %}
<div class="bg-white shadow-md rounded-lg p-8 max-w-lg mx-auto">
  <!-- Título -->
  <div class="flex items-center gap-3 mb-6">
    <i class="fas fa-box text-blue-600 text-2xl"></i>
    <h2 class="text-2xl font-bold text-gray-800">
      {{ 'Nuevo producto' if modo=='crear' else 'Editar producto' }}
    </h2>
  </div>

  <!-- Formulario -->
  <form method="post" novalidate class="space-y-5">
    {{ form.hidden_tag() }}

    <!-- Campo Nombre -->
    <div>
      <label class="block text-sm font-medium text-gray-700">{{ form.nombre.label }}</label>
      {{ form.nombre(class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm px-3 py-2 
                           focus:ring-blue-500 focus:border-blue-500 sm:text-sm") }}
      {% for e in form.nombre.errors %}
        <small class="text-red-600 text-sm">{{ e }}</small>
      {% endfor %}
    </div>

    <!-- Campo Cantidad -->
    <div>
      <label class="block text-sm font-medium text-gray-700">{{ form.cantidad.label }}</label>
      {{ form.cantidad(class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm px-3 py-2 
                              focus:ring-blue-500 focus:border-blue-500 sm:text-sm") }}
      {% for e in form.cantidad.errors %}
        <small class="text-red-600 text-sm">{{ e }}</small>
      {% endfor %}
    </div>

    <!-- Campo Precio -->
    <div>
      <label class="block text-sm font-medium text-gray-700">{{ form.precio.label }}</label>
      {{ form.precio(class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm px-3 py-2 
                             focus:ring-blue-500 focus:border-blue-500 sm:text-sm") }}
      {% for e in form.precio.errors %}
        <small class="text-red-600 text-sm">{{ e }}</small>
      {% endfor %}
    </div>

    <!-- Botones -->
    <div class="flex justify-end space-x-3 pt-4">
      <!-- Cancelar -->
      <a href="{{ url_for('listar_productos') }}"
         class="inline-flex items-center gap-2 bg-gray-200 text-gray-800 px-4 py-2 rounded-md hover:bg-gray-300 transition">
        <i class="fas fa-times"></i> Cancelar
      </a>

      <!-- Guardar -->
      {{ form.submit(class="inline-flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition") | safe }}
      <script>
        // Hack para añadir el ícono a submit si WTForms no lo permite directamente
        document.addEventListener("DOMContentLoaded", () => {
          let btn = document.querySelector("form button[type=submit]");
          if (btn && !btn.innerHTML.includes("fa-save")) {
            btn.innerHTML = '<i class="fas fa-save"></i> ' + btn.innerHTML;
          }
        });
      </script>
    </div>
  </form>
</div>
{% endblock %}
